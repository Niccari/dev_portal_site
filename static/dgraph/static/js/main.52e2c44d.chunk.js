(this.webpackJsonpdgraph=this.webpackJsonpdgraph||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},56:function(e,t){},64:function(e,t,n){},65:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n.n(a),o=n(27),s=n.n(o),c=(n(44),n(45),n(46),n(1)),u=function(e){var t=e.onDraw,n=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=null===n||void 0===n?void 0:n.current;e&&function(e){var t=Math.max(1e3*window.devicePixelRatio,4e3);e.width=t,e.height=t}(e)}),[]),Object(a.useEffect)((function(){var e=null===n||void 0===n?void 0:n.current;if(e){var r=e.getContext("2d");r&&t(r,e.width,e.height)}})),Object(c.jsx)("canvas",{className:"canvas",ref:n})},l=n(3),h=n.n(l),p=n(9),d=n(7),b=n(8);!function(e){e[e.UpdateAll=0]="UpdateAll",e[e.UpdateSimulation=1]="UpdateSimulation",e[e.UpdateAppearance=2]="UpdateAppearance",e[e.None=3]="None"}(r||(r={}));var f,g=function(){function e(t,n){Object(d.a)(this,e),this.snapshots=void 0,this.drawer=void 0,this.snapshots=t,this.drawer=n}return Object(b.a)(e,[{key:"toXRange",value:function(e){var t=e.xMin,n=e.xMax,r=e.xStep,a=Math.floor((n-t)/r)+1;return new Array(a).fill(0).map((function(e,n){return t+n*r}))}},{key:"findAction",value:function(e,t){if(!t)return r.UpdateAll;var n=e.equation!==t.equation||e.axis!==t.axis,a=e.chartAppearance.draw!==t.chartAppearance.draw||e.axis!==t.axis;return n&&a?r.UpdateAll:n?r.UpdateSimulation:a?r.UpdateAppearance:r.None}},{key:"update",value:function(){var e=Object(p.a)(h.a.mark((function e(t,n){var r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.toXRange(t.axis),a=this.findAction(t,n),e.abrupt("return",this.snapshots.update(t.equation,r,t.chartAppearance.draw,a));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"draw",value:function(e,t,n,r){var a=t.coordinate,i=t.axis,o=t.chartAppearance.thickness,s=this.snapshots.get(a);this.drawer.draw(e,s,i,o,n,r)}}]),e}(),j=n(13),v=function(){function e(){Object(d.a)(this,e)}return Object(b.a)(e,[{key:"draw",value:function(e,t,n,r,a,i){e.clearRect(0,0,a,i);for(var o=0;o<t.length-1;o++){var s=t[o],c=t[o+1];e.lineWidth=r,e.strokeStyle=t[o].drawSetting.color,e.beginPath();var u=this.rescalePoint(s,n,a,i),l=Object(j.a)(u,2),h=l[0],p=l[1];e.moveTo(h,p);var d=this.rescalePoint(c,n,a,i),b=Object(j.a)(d,2),f=b[0],g=b[1];e.lineTo(f,g),e.closePath(),e.stroke()}}},{key:"rescalePoint",value:function(e,t,n,r){var a=t.xMin,i=t.xMax,o=t.yMin,s=t.yMax;return[(e.value.x-a)/(i-a)*n,(1-(e.value.y-o)/(s-o))*r]}}]),e}(),x=n(67),m=function(){function e(){Object(d.a)(this,e)}return Object(b.a)(e,[{key:"create",value:function(){var e=Object(p.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(n.map(function(){var e=Object(p.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"number"!==typeof(r=Object(x.a)(t,{x:n}))){e.next=4;break}return e.abrupt("return",{x:n,y:r});case 4:return e.abrupt("return",{x:n,y:NaN});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",Promise.reject("Cannot eval"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),O=n(11);!function(e){e.Ortho="Ortho",e.Polar="Polar"}(f||(f={}));var w,S=function(){function e(t,n){Object(d.a)(this,e),this.simulator=void 0,this.visualizer=void 0,this.snapshotsOrtho=void 0,this.snapshotsPolar=void 0,this.simulator=t,this.visualizer=n,this.snapshotsOrtho=[],this.snapshotsPolar=[]}return Object(b.a)(e,[{key:"getValues",value:function(){var e=Object(p.a)(h.a.mark((function e(t,n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a!==r.UpdateAll&&a!==r.UpdateSimulation){e.next=6;break}return e.next=3,this.simulator.create(t,n).catch((function(e){return Promise.reject(e)}));case 3:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",this.snapshotsOrtho.map((function(e){return e.value})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getDrawSettings",value:function(){var e=Object(p.a)(h.a.mark((function e(t,n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a!==r.UpdateAll&&a!==r.UpdateAppearance){e.next=6;break}return e.next=3,this.visualizer.create(t,n);case 3:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",this.snapshotsOrtho.map((function(e){return e.drawSetting})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"toSnapshots",value:function(e,t,n){return new Array(e.length).fill(0).map((function(e,t){return t})).map((function(r){return{x:e[r],value:t[r],drawSetting:n[r]}}))}},{key:"update",value:function(){var e=Object(p.a)(h.a.mark((function e(t,n,a,i){var o,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i!==r.None){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getValues(t,n,i).catch((function(e){return Promise.reject(e)}));case 4:return o=e.sent,e.next=7,this.getDrawSettings(n,a,i);case 7:s=e.sent,this.snapshotsOrtho=this.toSnapshots(n,o,s),this.snapshotsPolar=this.snapshotsOrtho.map((function(e){return Object(O.a)(Object(O.a)({},e),{},{value:{x:Math.abs(e.value.y)*Math.cos(e.value.x),y:Math.abs(e.value.y)*Math.sin(e.value.x)}})}));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"get",value:function(e){switch(e){case f.Ortho:return this.snapshotsOrtho;case f.Polar:return this.snapshotsPolar}}}]),e}();!function(e){e.Rainbow="Rainbow",e.Fire="Fire",e.Green="Green",e.Ice="Ice",e.Heat="Heat",e.Monochrome="Monochrome",e.Pastel="Pastel"}(w||(w={}));var y,k,M=function(){function e(t){var n=this;Object(d.a)(this,e),this._config=void 0,this.colorStartIndex=void 0,this.colorIterateIndex=void 0,this.colorTable=[],this.gradientRainbows=[{position:0,red:255,green:0,blue:0},{position:43,red:255,green:255,blue:0},{position:85,red:0,green:255,blue:0},{position:128,red:0,green:255,blue:255},{position:171,red:0,green:0,blue:255},{position:223,red:255,green:0,blue:255},{position:255,red:255,green:0,blue:0}],this.gradientWarm=[{position:0,red:255,green:0,blue:0},{position:128,red:255,green:255,blue:0},{position:255,red:255,green:0,blue:0}],this.gradientForest=[{position:0,red:255,green:255,blue:0},{position:128,red:0,green:255,blue:0},{position:255,red:255,green:255,blue:0}],this.gradientCool=[{position:0,red:0,green:0,blue:255},{position:128,red:0,green:255,blue:255},{position:255,red:0,green:0,blue:255}],this.gradientHeat=[{position:0,red:255,green:255,blue:0},{position:43,red:255,green:0,blue:0},{position:85,red:0,green:0,blue:255},{position:128,red:0,green:0,blue:0},{position:171,red:0,green:0,blue:255},{position:223,red:255,green:0,blue:0},{position:255,red:255,green:255,blue:0}],this.gradientMonochrome=[{position:0,red:0,green:0,blue:0},{position:128,red:255,green:255,blue:255},{position:255,red:0,green:0,blue:0}],this.gradientPastel=[{position:0,red:255,green:154,blue:154},{position:85,red:255,green:255,blue:154},{position:170,red:154,green:255,blue:255},{position:255,red:255,green:154,blue:154}],this._colorToHex=function(e){var t=Math.round(e).toString(16);return 1==t.length?"0"+t:t},this._config=t,this.colorStartIndex=0,this.colorIterateIndex=0;for(var r=function(){switch(t.pattern){case w.Rainbow:return n.gradientRainbows;case w.Fire:return n.gradientWarm;case w.Green:return n.gradientForest;case w.Ice:return n.gradientCool;case w.Heat:return n.gradientHeat;case w.Monochrome:return n.gradientMonochrome;case w.Pastel:return n.gradientPastel}}(),a=1,i=r[0],o=r[1],s=0;s<256;s++){var c=(s-i.position)/(o.position-i.position),u=i.red+c*(o.red-i.red),l=i.green+c*(o.green-i.green),h=i.blue+c*(o.blue-i.blue);this.colorTable.push({position:s,red:u,green:l,blue:h}),o.position==s&&(i=o,o=r[++a])}}return Object(b.a)(e,[{key:"fetchColor",value:function(e){var t=Math.floor(e),n=Math.ceil(e)!==this.colorTable.length-1?Math.ceil(e):0,r=e-t,a=1-r,i={red:Math.floor(r*this.colorTable[t].red+a*this.colorTable[n].red),green:Math.floor(r*this.colorTable[t].green+a*this.colorTable[n].green),blue:Math.floor(r*this.colorTable[t].blue+a*this.colorTable[n].blue)};return"#"+this._colorToHex(i.red)+this._colorToHex(i.green)+this._colorToHex(i.blue)}},{key:"next",value:function(){var e=this.fetchColor(Math.floor(this.colorIterateIndex));return this.colorIterateIndex=(this.colorIterateIndex+this._config.colorStep)%256,e}},{key:"endIteration",value:function(){this.colorStartIndex=(this.colorStartIndex+this._config.colorStep)%256,this.colorIterateIndex=this.colorStartIndex}}]),e}(),I=function(){function e(){Object(d.a)(this,e)}return Object(b.a)(e,[{key:"create",value:function(){var e=Object(p.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new M(n),e.abrupt("return",t.map((function(){return{color:r.next()}})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),P=n(21),A=n(25);!function(e){e[e.Loading=0]="Loading",e[e.Completed=1]="Completed",e[e.Error=2]="Error"}(k||(k={}));var F={simulatingState:k.Completed,setting:{equation:"2(sin(5.01x) + cos(4.99x))sin(10x)",axis:{xStep:.001,xMin:-Math.PI,xMax:Math.PI,yMin:-Math.PI,yMax:Math.PI},coordinate:f.Polar,chartAppearance:{draw:{pattern:w.Rainbow,colorStep:256/(2*Math.PI/.001)},thickness:5}}},T=function(){var e=new URL(document.location.href).searchParams.get("setting")||"";try{return JSON.parse(atob(e))}catch(t){return F.setting}}(),N=Object(O.a)(Object(O.a)({},F),{},{setting:T}),C=Object(A.b)("simulation/simulateAsync",function(){var e=Object(p.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.setting,r=t.prevSetting,e.next=3,q.update(n,r).catch((function(e){return Promise.reject(e)}));case 3:return e.abrupt("return",t.setting);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U=Object(A.c)({name:"simulation",initialState:N,reducers:{},extraReducers:(y={},Object(P.a)(y,C.pending.toString(),(function(e){return Object(O.a)(Object(O.a)({},e),{},{simulatingState:k.Loading})})),Object(P.a)(y,C.rejected.toString(),(function(e){return Object(O.a)(Object(O.a)({},e),{},{simulatingState:k.Error})})),Object(P.a)(y,C.fulfilled.toString(),(function(e,t){var n=t.payload;return Object(O.a)(Object(O.a)({},e),{},{setting:n,simulatingState:k.Completed})})),y)}).reducer,R=new I,q=new g(new S(new m,R),new v);q.update(N.setting);var H=n(24),E=H.c,_=function(){var e=E((function(e){return e.simulation.setting}));return Object(c.jsx)(u,{onDraw:function(t,n,r){q.draw(t,e,n,r)}})},B=n(26),L=function(e){var t=e.simulatingState;return Object(c.jsxs)(c.Fragment,{children:[t===k.Loading&&Object(c.jsx)("span",{children:"\u23f0"}),t===k.Error&&Object(c.jsx)("span",{children:"\u274c"}),t===k.Completed&&Object(c.jsx)("span",{children:"\u2705"})]})},D=(n(64),function(e){var t=e.onSettingUpdate,n=e.simulatingState;return Object(c.jsx)(B.c,{initialValues:N.setting,onSubmit:function(e){t(e)},validate:function(e){var t={};return 0===e.equation.length&&(t.equation="\u5f0f\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044"),e.chartAppearance.thickness<=0&&(t.equation="\u7dda\u306e\u592a\u3055\u306f0\u4ee5\u4e0a\u306b\u3057\u3066\u304f\u3060\u3055\u3044"),t},children:function(e){var t=e.values,r=e.handleChange,a=e.handleBlur,i=e.handleSubmit,o=e.isValid;return Object(c.jsxs)(B.b,{onSubmit:i,className:"SettingForm",children:[Object(c.jsxs)("div",{className:"SettingFormItem",children:[Object(c.jsx)("label",{className:"SettingFormText",children:"f(x)="}),Object(c.jsx)(B.a,{type:"text",name:"equation",on:!0,onChange:r,onBlur:a,value:t.equation,placeholder:"\u65b9\u7a0b\u5f0f\u3092\u5165\u308c\u308b",required:!0,className:"SettingFormEquation"}),Object(c.jsx)(L,{simulatingState:n})]}),Object(c.jsxs)("div",{className:"SettingFormItem",children:[Object(c.jsx)("label",{className:"SettingFormText",children:"\u8272\u30d1\u30bf\u30fc\u30f3"}),Object(c.jsxs)("select",{name:"chartAppearance.draw.pattern",onChange:r,onBlur:a,value:t.chartAppearance.draw.pattern,children:[Object(c.jsx)("option",{value:w.Rainbow,children:"\u8679"}),Object(c.jsx)("option",{value:w.Fire,children:"\u708e"}),Object(c.jsx)("option",{value:w.Green,children:"\u6728\u6f0f\u308c\u65e5"}),Object(c.jsx)("option",{value:w.Ice,children:"\u6c37\u7d50"}),Object(c.jsx)("option",{value:w.Heat,children:"\u71b1"}),Object(c.jsx)("option",{value:w.Monochrome,children:"\u30e2\u30ce\u30af\u30ed"}),Object(c.jsx)("option",{value:w.Pastel,children:"\u30d1\u30b9\u30c6\u30eb"})]})]}),Object(c.jsxs)("div",{className:"SettingFormItem",children:[Object(c.jsx)("label",{className:"SettingFormText",children:"\u7dda\u306e\u592a\u3055"}),Object(c.jsx)(B.a,{type:"number",name:"chartAppearance.thickness",onChange:r,onBlur:a,value:t.chartAppearance.thickness})]}),Object(c.jsxs)("div",{className:"SettingFormItem",children:[Object(c.jsx)("label",{className:"SettingFormText",children:"\u5ea7\u6a19\u7cfb"}),Object(c.jsxs)("select",{name:"coordinate",onChange:r,onBlur:a,value:t.coordinate,children:[Object(c.jsx)("option",{value:f.Ortho,children:"\u76f4\u4ea4\u5ea7\u6a19"}),Object(c.jsx)("option",{value:f.Polar,children:"\u6975\u5ea7\u6a19"})]})]}),Object(c.jsx)("div",{className:"SettingFormItem",children:Object(c.jsx)("button",{type:"submit",disabled:!o,children:"\u8a2d\u5b9a\u3092\u66f4\u65b0\u3059\u308b"})})]})}})}),G=function(){var e=Object(H.b)(),t=E((function(e){return e.simulation.setting})),n=E((function(e){return e.simulation.simulatingState}));return Object(c.jsx)(D,{onSettingUpdate:function(n){e(C({setting:n,prevSetting:t}))},simulatingState:n})},J=function(){var e=E((function(e){return e.simulation.setting}));return Object(a.useEffect)((function(){var t=btoa(JSON.stringify(e)),n=window.location.pathname+"?setting="+t;window.history.replaceState(null,"update setting",n)})),Object(c.jsx)(c.Fragment,{})},V=function(){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(G,{}),Object(c.jsx)(_,{}),Object(c.jsx)(J,{})]})};var z=function(){return Object(c.jsx)(V,{})},W=Object(A.a)({reducer:{simulation:U}}),X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};s.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(H.a,{store:W,children:Object(c.jsx)(z,{})})}),document.getElementById("root")),X()}},[[65,1,2]]]);